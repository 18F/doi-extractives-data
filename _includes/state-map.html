{% assign _viewbox = include.viewbox | default: site.data.viewboxes.all %}
{% assign states_svg = '/maps/states/all.svg' %}
{% assign offshore_svg = '/maps/offshore/all.svg' %}

{% assign case_studies_points = site.data.case_studies_points %}
{% assign circle_radius = 17 %}

<div class="state svg-container map-container wide"{% if _viewbox %} style="padding-bottom: {{ _viewbox | svg_viewbox_padding }}%;"{% endif %}>
  <svg class="states map{% if include.case_studies %} case_studies {% endif %}{% if include.ownership %} ownership {% endif %}{% if include.no_outline %} no-outlines {% endif %}"{% if _viewbox %} viewBox="{{ _viewbox }}"{% endif %}>

    {% if include.states %}
      {%
        include maps/state-areas.html
        svg=states_svg
        value=include.value
        states=include.states
        no_ownership=include.case_studies
      %}
    {% endif %}

    {% if include.offshore_areas %}
      {%
        include maps/offshore-areas.html
        svg=offshore_svg
        value=include.value
        areas=include.offshore_areas
      %}
    {% endif %}

    {% if include.case_studies %}
      <g>
        {% for point in case_studies_points['coal'] %}
          {% assign point_name = point[1].name %}
          {% assign point_state = point[1].state %}
          {% assign coords = point[1].circle %}
          {% assign x_offset = coords.x | minus: circle_radius %}
          {% assign y_offset = coords.y | minus: circle_radius %}

          <g class="case-studies-circle-group">

            <circle class="{{ point_state }} coal" cx="{{ coords.x }}" cy="{{ coords.y }}" r="17" fill="#fff" stroke="#4b9bbf" stroke-width="2px"></circle>
            {% include svg/circle-icon-coal.svg x=x_offset y=y_offset %}
            <g>
              <rect width="200" height="50" stroke="#fff"></rect>
            </g>
          </g>
        {% endfor %}

        {% for point in case_studies_points['copper'] %}
          {% assign point_name = point[1].name %}
          {% assign point_state = point[1].state %}
          {% assign coords = point[1].circle %}
          {% assign x_offset = coords.x | minus: circle_radius %}
          {% assign y_offset = coords.y | minus: circle_radius %}

          <g class="case-studies-circle-group">

            <circle class="{{ point_state }} copper" cx="{{ coords.x }}" cy="{{ coords.y }}" r="17" fill="#fff" stroke="#4b9bbf" stroke-width="2px"></circle>
            {% include svg/circle-icon-copper.svg x=x_offset y=y_offset %}
            <g>
              <rect width="200" height="50" stroke="#fff"></rect>
            </g>
          </g>
        {% endfor %}

        {% for point in case_studies_points['gold'] %}
          {% assign point_name = point[1].name %}
          {% assign point_state = point[1].state %}
          {% assign coords = point[1].circle %}
          {% assign x_offset = coords.x | minus: circle_radius %}
          {% assign y_offset = coords.y | minus: circle_radius %}

          <g class="case-studies-circle-group">

            <circle class="{{ point_state }} gold" cx="{{ coords.x }}" cy="{{ coords.y }}" r="17" fill="#fff" stroke="#4b9bbf" stroke-width="2px"></circle>
            {% include svg/circle-icon-gold.svg x=x_offset y=y_offset %}
            <g>
              <rect width="200" height="50" stroke="#fff"></rect>
            </g>
          </g>
        {% endfor %}

        {% for point in case_studies_points['iron'] %}
          {% assign point_name = point[1].name %}
          {% assign point_state = point[1].state %}
          {% assign coords = point[1].circle %}
          {% assign x_offset = coords.x | minus: circle_radius %}
          {% assign y_offset = coords.y | minus: circle_radius %}

          <g class="case-studies-circle-group">

            <circle class="{{ point_state }} iron" cx="{{ coords.x }}" cy="{{ coords.y }}" r="17" fill="#fff" stroke="#4b9bbf" stroke-width="2px"></circle>
            {% include svg/circle-icon-iron.svg x=x_offset y=y_offset %}
            <g>
              <rect width="200" height="50" stroke="#fff"></rect>
            </g>
          </g>
        {% endfor %}

        {% for point in case_studies_points['gas'] %}
          {% assign point_name = point[1].name %}
          {% assign point_state = point[1].state %}
          {% assign coords = point[1].circle %}
          {% assign x_offset = coords.x | minus: circle_radius %}
          {% assign y_offset = coords.y | minus: circle_radius %}

          <g class="case-studies-circle-group">

            <circle class="{{ point_state }} gas" cx="{{ coords.x }}" cy="{{ coords.y }}" r="17" fill="#fff" stroke="#4b9bbf" stroke-width="2px"></circle>
            {% include svg/circle-icon-gas.svg x=x_offset y=y_offset %}
            <g>
              <rect width="200" height="50" stroke="#fff"></rect>
            </g>
          </g>
        {% endfor %}

        {% for point in case_studies_points['oil'] %}
          {% assign point_name = point[1].name %}
          {% assign point_state = point[1].state %}
          {% assign coords = point[1].circle %}
          {% assign x_offset = coords.x | minus: circle_radius %}
          {% assign y_offset = coords.y | minus: circle_radius %}

          <g class="case-studies-circle-group">

            <circle class="{{ point_state }} oil" cx="{{ coords.x }}" cy="{{ coords.y }}" r="17" fill="#fff" stroke="#4b9bbf" stroke-width="2px"></circle>
            {% include svg/circle-icon-oil.svg x=x_offset y=y_offset %}
            <g>
              <rect width="200" height="50" stroke="#fff"></rect>
            </g>
          </g>
        {% endfor %}


      </g>
    {% endif %}

  </svg>
</div>
